(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-31817fc4"],{"1dde":function(e,t,a){var o=a("d039"),r=a("b622"),l=a("2d00"),i=r("species");e.exports=function(e){return l>=51||!o((function(){var t=[],a=t.constructor={};return a[i]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"914a":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-view"},[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.tempList},on:{"expand-change":e.handleMange}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{attrs:{label:"项目ID:"}},[a("span",[e._v(e._s(t.row.projectId))])]),a("el-form-item",{attrs:{label:"项目名称:"}},[a("span",[e._v(e._s(t.row.projectName))])]),a("el-form-item",{attrs:{label:"负责人:"}},[a("span",[e._v(e._s(e.userInfo.userName))])]),a("el-form-item",{attrs:{label:"学号:"}},[a("span",[e._v(e._s(t.row.userId))])]),a("el-form-item",{attrs:{label:"联系方式:"}},[a("span",[e._v(e._s(e.userInfo.userPhone))])]),a("el-form-item",{attrs:{label:"项目等级:"}},[1===t.row.grade?a("span",[e._v("校级")]):e._e(),2===t.row.grade?a("span",[e._v("省级")]):e._e(),3===t.row.grade?a("span",[e._v("国家级")]):e._e(),0===t.row.grade?a("span",[e._v("无")]):e._e()]),a("el-form-item",{attrs:{label:"指导老师1:"}},[null!==t.row.oneId?a("span",[e._v(e._s(t.row.oneId))]):a("span",[e._v("无")])]),a("el-form-item",{attrs:{label:"指导老师2:"}},[null!==t.row.twoId?a("span",[e._v(e._s(t.row.twoId))]):a("span",[e._v("无")])]),a("el-form-item",{attrs:{label:"立案申请:"}},[1==t.row.sreport?a("span",{staticStyle:{color:"green"}},[e._v("已提交")]):a("span",{staticStyle:{color:"red"}},[e._v("未提交")])]),a("el-form-item",{attrs:{label:"中期报告:"}},[1==t.row.mreport?a("span",{staticStyle:{color:"green"}},[e._v("已提交")]):a("span",{staticStyle:{color:"red"}},[e._v("未提交")])]),a("el-form-item",{attrs:{label:"结案报告:"}},[1==t.row.freport?a("span",{staticStyle:{color:"green"}},[e._v("已提交")]):a("span",{staticStyle:{color:"red"}},[e._v("未提交")])])],1)]}}])}),[a("el-table-column",{attrs:{label:"项目名称",width:"283",prop:"projectName"}}),a("el-table-column",{attrs:{label:"项目负责人学号",width:"150",prop:"userId"}}),a("el-table-column",{attrs:{label:"所属学院",width:"150",prop:"collegeId",formatter:e.GetCollegeName}}),a("el-table-column",{attrs:{label:"项目等级",width:"90",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.grade?a("span",[e._v("校级")]):e._e(),2===t.row.grade?a("span",[e._v("省级")]):e._e(),3===t.row.grade?a("span",[e._v("国家级")]):e._e(),0===t.row.grade?a("span",[e._v("无")]):e._e()]}}])}),a("el-table-column",{attrs:{label:"中期报告",width:"90",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.mreport?a("span",{staticStyle:{color:"green"}},[e._v("已提交")]):a("span",{staticStyle:{color:"red"}},[e._v("未提交")])]}}])})],a("el-table-column",{attrs:{label:"中期报告操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.mReport(t.$index,t.row)}}},[e._v("查看")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.mReportNew(t.$index,t.row)}}},[e._v("新建")])]}}])})],2),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[1,5,10,20],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1),a("el-dialog",{staticClass:"midReport",attrs:{visible:e.dialogFormVisibleNew,title:"新建中期报告"},on:{"update:visible":function(t){e.dialogFormVisibleNew=t}},model:{value:e.dialogFormVisibleNew,callback:function(t){e.dialogFormVisibleNew=t},expression:"dialogFormVisibleNew"}},[a("el-form",{staticClass:"mReportForm"},[a("el-form-item",{attrs:{label:"项目名称:","label-width":"100px"}},[a("span",[e._v(e._s(e.midReportNew.projectName))])]),a("el-form-item",{attrs:{label:"项目编号:","label-width":"100px"}},[a("span",[e._v(e._s(e.midReportNew.projectId))])]),a("el-form-item",{attrs:{label:"学生学号","label-width":"100px"}},[a("span",[e._v(e._s(e.midReportNew.userId))])]),a("el-form-item",{attrs:{label:"中期报告简介","label-width":"100px"}},[a("el-input",{model:{value:e.midReportNew.content,callback:function(t){e.$set(e.midReportNew,"content",t)},expression:"midReportNew.content"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitMreport}},[e._v("新建")])],1)],1),a("el-dialog",{staticClass:"midReport",attrs:{visible:e.dialogFormVisible,title:"中期报告详情"},on:{"update:visible":function(t){e.dialogFormVisible=t}},model:{value:e.dialogFormVisible,callback:function(t){e.dialogFormVisible=t},expression:"dialogFormVisible"}},[[a("el-form",{staticClass:"mReportForm",attrs:{model:e.midReport}},[a("el-form-item",{attrs:{label:"项目名称:","label-width":"100px"}},[a("span",[e._v(e._s(e.projectName))])]),a("el-form-item",{attrs:{label:"中期报告简介:","label-width":"100px"}},[0==e.changeContentValue?a("span",[a("span",[e._v(e._s(e.content))]),a("a",{staticClass:"changeContent",attrs:{href:"javascript:;"},on:{click:function(t){e.changeContentValue=!0}}},[e._v("修改")])]):a("el-form",{staticClass:"contentForm"},[a("el-input",{model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.changeContent}},[e._v("确定")])],1)],1),a("el-form-item",{staticClass:"midDisscuss",attrs:{label:"导师评议:","label-width":"100px"}},[0===e.midReport.tapproval?a("span",[e._v("未审核")]):e._e(),1===e.midReport.tapproval?a("span",{staticStyle:{color:"red"}},[e._v("不通过")]):e._e(),2===e.midReport.tapproval?a("span",{staticStyle:{color:"green"}},[e._v("已通过")]):e._e(),3===e.midReport.tapproval?a("span",{staticStyle:{color:"orange"}},[e._v("退回修改")]):e._e()]),a("el-form-item",{staticClass:"midDisscuss",attrs:{label:"学院评议:","label-width":"100px"}},[0===e.midReport.capproval?a("span",[e._v("未审核")]):e._e(),1===e.midReport.capproval?a("span",{staticStyle:{color:"red"}},[e._v("不通过")]):e._e(),2===e.midReport.capproval?a("span",{staticStyle:{color:"green"}},[e._v("已通过")]):e._e(),3===e.midReport.capproval?a("span",{staticStyle:{color:"orange"}},[e._v("退回修改")]):e._e()]),a("el-form-item",{staticClass:"midDisscuss",attrs:{label:"大创管理评议:","label-width":"100px"}},[0===e.midReport.sapproval?a("span",[e._v("未审核")]):e._e(),1===e.midReport.sapproval?a("span",{staticStyle:{color:"red"}},[e._v("不通过")]):e._e(),2===e.midReport.sapproval?a("span",{staticStyle:{color:"green"}},[e._v("已通过")]):e._e(),3===e.midReport.sapproval?a("span",{staticStyle:{color:"orange"}},[e._v("退回修改")]):e._e()]),a("el-form-item",{staticClass:"midDisscuss",attrs:{label:"评审专家评议:","label-width":"100px"}},[0===e.midReport.eapproval?a("span",[e._v("未审核")]):e._e(),1===e.midReport.eapproval?a("span",{staticStyle:{color:"red"}},[e._v("不通过")]):e._e(),2===e.midReport.eapproval?a("span",{staticStyle:{color:"green"}},[e._v("已通过")]):e._e(),3===e.midReport.eapproval?a("span",{staticStyle:{color:"orange"}},[e._v("退回修改")]):e._e()]),a("el-form-item",{attrs:{label:"导师评语:","label-width":"100px"}},[e.midReport.tcomment?a("span",[e._v(e._s(e.midReport.tcomment))]):a("span",[e._v("无")])]),a("el-form-item",{attrs:{label:"学院评语:","label-width":"100px"}},[e.midReport.ccomment?a("span",[e._v(e._s(e.midReport.ccomment))]):a("span",[e._v("无")])]),a("el-form-item",{attrs:{label:"大创管理评语:","label-width":"100px"}},[e.midReport.scomment?a("span",[e._v(e._s(e.midReport.scomment))]):a("span",[e._v("无")])]),a("el-form-item",{attrs:{label:"评审专家:","label-width":"100px"}},[e.midReport.expertName?a("span",[e._v(e._s(e.midReport.expertName))]):a("span",[e._v("无")])]),a("el-form-item",{attrs:{label:"评审专家评语:","label-width":"100px"}},[e.midReport.ecomment?a("span",[e._v(e._s(e.midReport.ecomment))]):a("span",[e._v("无")])]),a("el-form-item",{staticStyle:{margin:"0"},attrs:{label:"上传文件:","label-width":"100px",enctype:"multipart/form-data"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"",multiple:"",limit:1,"http-request":e.beforeUpload,"show-file-list":!1}},[a("el-button",{attrs:{slot:"trigger",size:"mini",type:"primary"},slot:"trigger"},[e._v("选取文件")]),a("div",{staticClass:"el-upload__tip",staticStyle:{margin:"0"},attrs:{slot:"tip"},slot:"tip"},[e._v("文件不超过5MB")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.submitUpload()}}},[e._v("上传")]),!0===e.fileShow?a("p",{staticStyle:{"font-size":"12px",color:"#ccc",margin:"0"}},[e._v(e._s(e.mfileNewName))]):e._e()],1)],1),a("el-form-item",{staticStyle:{width:"90%"},attrs:{label:"文件列表:","label-width":"100px"}},[a("el-table",{staticStyle:{width:"100%","font-size":"12px"},attrs:{data:e.mfiles,height:"250",border:""}},[a("el-table-column",{attrs:{prop:"fname",label:"文件名",width:"210"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{attrs:{tag:"a",target:"_blank",href:"http://47.113.80.250:8012/onlinePreview?url="+t.row.furl}},[a("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("预览")])],1),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.download(t.row)}}},[e._v("下载")]),a("el-popconfirm",{staticStyle:{"margin-left":"10px"},attrs:{confirmButtonText:"确认",cancelButtonText:"不了",icon:"el-icon-info",title:"确定删除该文件吗？"},on:{onConfirm:function(a){return e.deleteFile(t.$index,t.row)}}},[a("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[e._v("删除")])],1)]}}])})],1)],1)],1)],a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("确定")])],1)],2)],1)},r=[],l=(a("4160"),a("a434"),a("b0c0"),a("d3b7"),a("3ca3"),a("159b"),a("ddb0"),a("2b3d"),a("0b22")),i={data:function(){return{tableData:[],userId:"",dialogFormVisible:!1,dialogFormVisibleNew:!1,baseUrl:"",userInfo:[],total:0,tempList:[],currentPage:1,pageSize:10,midReport:[],midReportNew:[],projectName:"",mfiles:[],content:"",changeContentValue:!1,fileShow:!1,mfileNewName:"",mfileForm:new FormData,collegeList:[{id:1,name:"计算机科学与工程学院"},{id:2,name:"政法学院"},{id:3,name:"电子信息与电气工程学院"},{id:4,name:"地理与旅游学院"},{id:5,name:"数学与大数据学院"},{id:6,name:"化学与材料工程学院"},{id:7,name:"建筑与土木工程学院"},{id:8,name:"旭日广东服装学院"},{id:9,name:"生命科学学院"},{id:10,name:"经济管理学院"},{id:11,name:"体育学院"}]}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.userId=localStorage.getItem("USERID"),Object(l["a"])({url:"http://47.113.80.250:9003/project/select/"+this.userId,method:"get"}).then((function(t){return e.tableData=[],console.log(t),t.data.forEach((function(t){e.tableData.push(t)})),e.total=e.tableData.length,e.tempList=e.tableData,e.tempList}))},GetCollegeName:function(e){for(var t in console.log(e.collegeId),this.collegeList)if(e.collegeId===this.collegeList[t].id)return this.collegeList[t].name},handleMange:function(e,t){var a=this;console.log(t),Object(l["a"])({url:"http://47.113.80.250:9003/user/select/"+t[0].userId,method:"get"}).then((function(e){a.userInfo=[],a.userInfo=t,a.userInfo.userCollege=e.data.college.collegeName,a.userInfo.userName=e.data.user.userName,a.userInfo.userPhone=e.data.user.phone}))},handleSizeChange:function(e){this.pageSize=e,this.handleCurrentChange(this.currentPage)},handleCurrentChange:function(e){this.currentPage1=e,this.currentChangePage(this.tableData,e),console.log(this.tableData)},currentChangePage:function(e,t){var a=(t-1)*this.pageSize,o=t*this.pageSize;for(this.tempList=[];a<o;a++)e[a]&&this.tempList.push(e[a])},mReport:function(e,t){var a=this;Object(l["a"])({url:"http://47.113.80.250:9003/report/select/"+t.projectId,method:"get"}).then((function(e){if(console.log(e),console.log("1111"),200===e.code)return a.projectName=t.projectName,a.midReport=e.data.mreport,a.mfiles=e.data.mfiles,a.content=e.data.mreport.content,a.midReport.expertName=e.data.expertName,console.log(a),e.code;alert(e.message)})).then((function(e){200===e&&(a.dialogFormVisible=!0)}))},mReportNew:function(e,t){console.log(t),1===t.mreport?alert("您已建立了中期报告，请查看并修改"):0===t.mreport&&(this.midReportNew.projectId=t.projectId,this.midReportNew.projectName=t.projectName,this.midReportNew.userId=t.userId,this.dialogFormVisibleNew=!0)},submitMreport:function(){var e=this;Object(l["a"])({url:"http://47.113.80.250:9003/report/student/insert",data:{content:this.midReportNew.content,projectId:this.midReportNew.projectId,userId:this.midReportNew.userId},method:"POST"}).then((function(t){console.log(t),200===t.code?(alert("新建成功！"),e.dialogFormVisibleNew=!1,e.$router.go(0)):alert(t.message)}))},deleteFile:function(e,t){var a=this,o=t.fid;Object(l["a"])({url:"http://47.113.80.250:9003/report/student/file/delete",data:{fileId:o},method:"POST"}).then((function(t){200===t.code?(alert("删除成功"),a.mfiles.splice(e,1)):alert(t.message)}))},changeContent:function(){var e=this;Object(l["a"])({url:"http://47.113.80.250:9003/report/student/update",data:{content:this.content,reportId:this.midReport.reportId},method:"POST"}).then((function(t){alert("修改简介成功！"),e.changeContentValue=!1}))},beforeUpload:function(e){console.log(e);var t=new FormData;console.log(t),t.append("file",e.file),t.append("reportId",this.midReport.reportId),this.mfileForm=t,console.log(this.mfileNewForm),this.fileShow=!0,this.mfileNewName=e.file.name;var a=e.file.size/1024/1024<5;return a||this.$message.error("上传文件大小不能超过 5MB!"),a},submitUpload:function(){var e=this;console.log(this.mfileNewForm),!0!==this.fileShow?alert("请选择上传文件！"):Object(l["a"])({url:"http://47.113.80.250:9003/report/student/file/insert/one",data:this.mfileForm,method:"POST"}).then((function(t){if(200!==t.code)throw err;alert(t.message),e.$router.go(0)})).catch((function(e){alert(e)}))},download:function(e){Object(l["a"])({url:"http://47.113.80.250:9002/download",data:{fileUrl:e.furl,fileName:e.fname},method:"POST",responseType:"blob"}).then((function(t){var a=t,o=new Blob([a]),r=e.fname,l=document.createElement("a");l.download=r,l.href=URL.createObjectURL(o),document.body.appendChild(l),l.click(),URL.revokeObjectURL(l.href),document.body.removeChild(l)}))}}},n=i,s=(a("bf13"),a("2877")),c=Object(s["a"])(n,o,r,!1,null,"661dabc3",null);t["default"]=c.exports},a434:function(e,t,a){"use strict";var o=a("23e7"),r=a("23cb"),l=a("a691"),i=a("50c4"),n=a("7b0b"),s=a("65f0"),c=a("8418"),p=a("1dde"),m=a("ae40"),d=p("splice"),u=m("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,h=Math.min,b=9007199254740991,g="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!d||!u},{splice:function(e,t){var a,o,p,m,d,u,v=n(this),_=i(v.length),w=r(e,_),y=arguments.length;if(0===y?a=o=0:1===y?(a=0,o=_-w):(a=y-2,o=h(f(l(t),0),_-w)),_+a-o>b)throw TypeError(g);for(p=s(v,o),m=0;m<o;m++)d=w+m,d in v&&c(p,m,v[d]);if(p.length=o,a<o){for(m=w;m<_-o;m++)d=m+o,u=m+a,d in v?v[u]=v[d]:delete v[u];for(m=_;m>_-o+a;m--)delete v[m-1]}else if(a>o)for(m=_-o;m>w;m--)d=m+o-1,u=m+a-1,d in v?v[u]=v[d]:delete v[u];for(m=0;m<a;m++)v[m+w]=arguments[m+2];return v.length=_-o+a,p}})},a62c:function(e,t,a){},bf13:function(e,t,a){"use strict";var o=a("a62c"),r=a.n(o);r.a}}]);
//# sourceMappingURL=chunk-31817fc4.db4a494b.js.map